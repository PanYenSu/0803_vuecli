(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4812141b"],{"25f0":function(t,e,a){"use strict";var s=a("6eeb"),r=a("825a"),o=a("d039"),i=a("ad6d"),n="toString",c=RegExp.prototype,l=c[n],u=o((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),d=l.name!=n;(u||d)&&s(RegExp.prototype,n,(function(){var t=r(this),e=String(t.source),a=t.flags,s=String(void 0===a&&t instanceof RegExp&&!("flags"in c)?i.call(t):a);return"/"+e+"/"+s}),{unsafe:!0})},"5d3a":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container py-3"},[a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),t._m(0),a("div",{staticClass:"content"},[t._m(1),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-5"},[a("div",{staticClass:"border p-3 mx-2 mb-4 order-card"},[a("h4",{staticClass:"mb-4 font-weight-bold"},[t._v("購物明細")]),a("hr",{attrs:{size:"8px",align:"center",width:"100%"}}),t._l(t.cartProducts,(function(e){return a("div",{key:e.product.id+1},[a("div",{staticClass:"d-flex mb-2 bg-light"},[a("img",{staticClass:"mr-2",staticStyle:{width:"48px",height:"48px","object-fit":"cover"},attrs:{src:e.product.imageUrl[0],alt:""}}),a("div",{staticClass:"w-100"},[a("div",{staticClass:"d-flex justify-content-between font-weight-bold"},[a("p",{staticClass:"mb-0"},[t._v(t._s(e.product.title))]),a("p",{staticClass:"mb-0"},[t._v("x"+t._s(e.quantity))])]),a("div",{staticClass:"d-flex justify-content-between"},[a("small",{staticClass:"mb-0 text-muted"},[t._v(" "+t._s(t._f("currency")(e.product.price))+" / "+t._s(e.product.unit)+" ")])])])]),a("hr",{attrs:{size:"8px",align:"center",width:"100%"}})])})),a("ul",{staticClass:"pb-2 mb-2 border-bottom"},[a("li",{staticClass:"d-flex justify-content-between"},[a("span",{staticClass:"fz-2 lh-4"},[t._v("商品金額")]),a("span",{staticClass:"fz-2 lh-4"},[t._v(t._s(t._f("currency")(t.cartTotal)))])]),a("li",{staticClass:"d-flex justify-content-between"},[a("div",{staticClass:"input-group mt-3 input-group-sm"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],staticClass:"form-control",attrs:{type:"text",placeholder:"我的優惠碼 GOODDAY"},domProps:{value:t.couponCode},on:{input:function(e){e.target.composing||(t.couponCode=e.target.value)}}}),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-warm",attrs:{type:"button",disabled:t.isEnable},on:{click:function(e){return e.preventDefault(),t.getCoupon(e)}}},[!0===t.isEnable?a("i",{staticClass:"spinner-border spinner-border-sm"}):t._e(),t._v("套用優惠 ")])])])])]),a("ul",{staticClass:"pb-2 mb-2 border-bottom"},[a("li",{staticClass:"d-flex justify-content-between"},[a("span",{staticClass:"fz-2 lh-4"},[t._v("優惠折扺")]),t.coupon.enabled?a("span",{staticClass:"fz-2 lh-4"},[t._v(" - "+t._s(t._f("currency")(t.discount)))]):a("span",{staticClass:"fz-2 lh-4"},[t._v(t._s(t._f("currency")(0))+" ")])]),a("li",{staticClass:"d-flex justify-content-between"},[a("span",{staticClass:"fz-2 lh-4"},[t._v("運費")]),a("span",{staticClass:"fz-2 lh-4"},[t._v(" "+t._s(t.cartTotal-t.discount>=1e3?"您已到達免運門檻 $0":"$60"))])])]),a("div",{staticClass:"d-flex justify-content-between"},[a("p",{staticClass:"mb-0 h5 font-weight-bold"},[t._v("應付金額")]),a("p",{staticClass:"mb-0 h4 font-weight-bold"},[t._v(" "+t._s(t._f("currency")(t.payable))+" ")])])],2)]),a("div",{staticClass:"col-md-7 card"},[a("validation-observer",{staticClass:"col-md-12 text-left mt-3",scopedSlots:t._u([{key:"default",fn:function(e){var s=e.invalid;return[a("form",{on:{submit:function(e){return e.preventDefault(),t.createOrder(e)}}},[a("div",{staticClass:"form-group"},[a("validation-provider",{attrs:{rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes,o=e.passed;return[a("label",{attrs:{for:"email"}},[t._v("Email")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"form-control",class:r,attrs:{id:"email",type:"email"},domProps:{value:t.form.email},on:{input:function(e){e.target.composing||t.$set(t.form,"email",e.target.value)}}}),s[0]?a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e(),o?a("span",{staticClass:"valid-feedback"}):t._e()]}}],null,!0)})],1),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("div",{staticClass:"form-group"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes;return[a("label",{attrs:{for:"username"}},[t._v("收件人姓名")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"form-control",class:r,attrs:{id:"username",type:"text"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}}),s[0]?a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1)]),a("div",{staticClass:"col"},[a("div",{staticClass:"form-group"},[a("validation-provider",{attrs:{rules:"required|min:8"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes;return[a("label",{attrs:{for:"tel"}},[t._v("連絡電話")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.tel,expression:"form.tel"}],staticClass:"form-control",class:r,attrs:{id:"tel",type:"tel"},domProps:{value:t.form.tel},on:{input:function(e){e.target.composing||t.$set(t.form,"tel",e.target.value)}}}),s[0]?a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1)])]),a("div",{staticClass:"form-group"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes;return[a("label",{attrs:{for:"address"}},[t._v("收件人地址")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.address,expression:"form.address"}],staticClass:"form-control",class:r,attrs:{id:"address",type:"text"},domProps:{value:t.form.address},on:{input:function(e){e.target.composing||t.$set(t.form,"address",e.target.value)}}}),s[0]?a("span",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"message"}},[t._v("付款方式")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.form.payment,expression:"form.payment"}],staticClass:"form-control",attrs:{required:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form,"payment",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:""}},[t._v(" 請選擇付款方式 ")]),a("option",{attrs:{value:"WebATM"}},[t._v(" WebATM ")]),a("option",{attrs:{value:"ATM"}},[t._v(" ATM ")]),a("option",{attrs:{value:"CVS"}},[t._v(" CVS ")]),a("option",{attrs:{value:"Barcode"}},[t._v(" Barcode ")]),a("option",{attrs:{value:"Credit"}},[t._v(" Credit ")]),a("option",{attrs:{value:"ApplePay"}},[t._v(" ApplePay ")]),a("option",{attrs:{value:"GooglePay"}},[t._v(" GooglePay ")])])]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"message"}},[t._v("留言")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{id:"message",cols:"30",rows:"6"},domProps:{value:t.form.message},on:{input:function(e){e.target.composing||t.$set(t.form,"message",e.target.value)}}})]),a("div",{staticClass:"modal-footer d-flex justify-content-center"},[a("button",{staticClass:"w-25 badge-light2 btn btn-light",attrs:{type:"button"},on:{click:function(e){return t.$router.push("/cart")}}},[a("i",{staticClass:"returnIcon fas fa-angle-left"}),t._v("回購物車")]),a("button",{staticClass:"w-25 badge-secondary btn btn-primary",attrs:{type:"submit",disabled:s},on:{click:function(e){return e.preventDefault(),t.createOrder(e)}}},[t._v(" 送出訂單 ")])])])]}}])})],1)])])],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"progress"},[a("div",{staticClass:"progress-bar bg-warm3 progress-bar-striped progress-bar-animated",staticStyle:{width:"60%"},attrs:{role:"progressbar","aria-valuenow":"75","aria-valuemin":"0","aria-valuemax":"100"}},[a("span",{staticClass:"sr-only"},[t._v("60% 完成")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header"},[a("h4",{staticClass:"py-3"},[t._v("訂購表單")])])}],o=(a("99af"),a("4160"),a("d3b7"),a("25f0"),a("159b"),a("130b")),i={data:function(){return{form:{name:"",email:"",tel:"",address:"",payment:"",message:""},isLoading:!1,quantity:0,cartProducts:{},cartTotal:0,coupon:{},couponCode:"",discount:0,payable:0,shippingFee:0,isEnable:!1,uuid:"7f1638b3-f468-4c9d-a7b1-49b0ae75cd3d",path:"https://course-ec-api.hexschool.io/api/"}},methods:{getCoupon:function(){var t=this;this.isEnable=!0,this.discount=0;var e="".concat(this.path).concat(this.uuid,"/ec/coupon/search");this.$http.post(e,{code:this.couponCode}).then((function(e){t.isEnable=!1,t.coupon=e.data.data,t.discount=t.cartTotal*(t.coupon.percent/100),t.getCartList(),o["a"].fire({text:"成功套用優惠卷".concat(t.couponCode,"_").concat(t.discount),icon:"success"})})).catch((function(e){t.isEnable=!1,t.getCartList();var a=e.response.data.errors;if(a)a.code.forEach((function(t){o["a"].fire({title:"".concat(t),icon:"error"})}));else{var s=e.response.data.message;o["a"].fire({title:"".concat(s),icon:"error"})}}))},createOrder:function(){var t=this;this.isLoading=!0;var e=this.payable.toString();this.$bus.$emit("get-pay",e);var a="".concat(this.path).concat(this.uuid,"/ec/orders");this.$http.post(a,this.form).then((function(e){var a=e.data.data.id;e.data.data.id&&(t.isLoading=!1,t.$router.push("/checkout/".concat(a)),t.$bus.$emit("get-cart"),o["a"].fire({text:"您已送出訂單!",icon:"success"}))})).catch((function(e){t.isLoading=!1,console.log(e.response.data.errors)}))},getCartList:function(){var t=this;this.isLoading=!0;var e="".concat(this.path).concat(this.uuid,"/ec/shopping");this.$http.get(e).then((function(e){t.cartProducts=e.data.data,console.log(t.cartProducts),t.isLoading=!1,t.cartTotal=0,t.quantity=0,t.cartProducts.forEach((function(e){t.cartTotal+=e.product.price*e.quantity,t.quantity+=e.quantity})),t.payable=t.cartTotal-t.discount,t.payable<1e3?t.shippingFee=60:t.shippingFee=0,t.payable+=t.shippingFee,t.couponCode=""})).catch((function(e){t.isLoading=!1,t.$bus.$emit("message:push","購物車載入失敗，".concat(e),"danger")}))}},created:function(){this.getCartList()},computed:{getDiscount:function(){return this.coupon.enabled?this.cartTotal*(this.coupon.percent/100):this.discount}}},n=i,c=a("2877"),l=Object(c["a"])(n,s,r,!1,null,null,null);e["default"]=l.exports},"99af":function(t,e,a){"use strict";var s=a("23e7"),r=a("d039"),o=a("e8b5"),i=a("861d"),n=a("7b0b"),c=a("50c4"),l=a("8418"),u=a("65f0"),d=a("1dde"),p=a("b622"),f=a("2d00"),m=p("isConcatSpreadable"),v=9007199254740991,g="Maximum allowed index exceeded",b=f>=51||!r((function(){var t=[];return t[m]=!1,t.concat()[0]!==t})),h=d("concat"),C=function(t){if(!i(t))return!1;var e=t[m];return void 0!==e?!!e:o(t)},_=!b||!h;s({target:"Array",proto:!0,forced:_},{concat:function(t){var e,a,s,r,o,i=n(this),d=u(i,0),p=0;for(e=-1,s=arguments.length;e<s;e++)if(o=-1===e?i:arguments[e],C(o)){if(r=c(o.length),p+r>v)throw TypeError(g);for(a=0;a<r;a++,p++)a in o&&l(d,p,o[a])}else{if(p>=v)throw TypeError(g);l(d,p++,o)}return d.length=p,d}})}}]);
//# sourceMappingURL=chunk-4812141b.eebb30f3.js.map